# FPGA-NT35510-TFT-LCD-Driver

基于 Verilog 实现的 NT35510 控制器 4.3寸 TFT-LCD 屏幕驱动。

**该驱动基于正点原子MD-0430用户手册的源码修改而成**

## 一、项目简介

本项目提供了一个用于驱动 **4.3英寸 TFT-LCD 液晶屏**的 Verilog 硬件逻辑模块。屏幕控制器型号为 **NT35510**，采用 16-bit 8080 并口通信模式。

本项目是这个驱动模块的一个演示实例，实现了基于LCD显示的飞机大战小游戏

> **⚠️ 注意:**
> * 本驱动仅包含 **显示驱动**，**不包含触摸功能**。
> * 默认配置为 RGB565 颜色格式。

## 二、硬件引脚定义

根据开发板原理图，FPGA 与 LCD 屏幕的物理引脚连接映射如下。

| 信号名称| FPGA 管脚|
| :--- | :--- |
| **LCD1_RST#** | **J25** |
| **LCD1_CS#** | **H18** |
| **LCD1_RS** | **K16** |
| **LCD1_WR#** | **L8** |
| **LCD1_RD#** | **K8** |
| **LCD1_BL_CTR** | **J15** |
| **LCD1_DB[1]** | **H9** |
| **LCD1_DB[2]** | **K17** |
| **LCD1_DB[3]** | **J20** |
| **LCD1_DB[4]** | **M17** |
| **LCD1_DB[5]** | **L17** |
| **LCD1_DB[6]** | **L18** |
| **LCD1_DB[7]** | **L15** |
| **LCD1_DB[8]** | **M15** |
| **LCD1_DB[10]** | **M16** |
| **LCD1_DB[11]** | **L14** |
| **LCD1_DB[12]** | **M14** |
| **LCD1_DB[13]** | **F22** |
| **LCD1_DB[14]** | **G22** |
| **LCD1_DB[15]** | **G21** |
| **LCD1_DB[16]** | **H24** |
| **LCD1_DB[17]** | **J16** |

## 三、LCD模块接口

### 1. 模块端口定义

| 端口名 | 方向 | 位宽 | 描述 |
| :--- | :--- | :--- | :--- |
| `clk` | Input | 1 | **时钟输入**(100MHZ)|
| `rst_n` | Input | 1 | **系统复位** |
| `pixel_data`| Input | [15:0] | **RGB565 像素数据输入** |
| `pixel_en` | Input | 1 | **写数据使能** (当 lcd_ready=1 时，拉高一个周期写入) |
| `lcd_ready` | Output | 1 | **忙闲标志位** (1: 空闲，可接收数据; 0: 忙碌) |
| `lcd_db` | Output | [15:0] | 连接到 LCD 数据总线 |
| `lcd_wr` | Output | 1 | 连接到 LCD 写信号 |
| `lcd_rd` | Output | 1 | 连接到 LCD 读信号 |
| `lcd_rs` | Output | 1 | 连接到 LCD 命令/数据选择 |
| `lcd_cs` | Output | 1 | 连接到 LCD 片选 |
| `lcd_rst` | Output | 1 | 连接到 LCD 复位 |
| `lcd_bl` | Output | 1 | 连接到 LCD 背光 |

### 2. 驱动使用流程

本模块采用 **“握手”机制** 来写入像素数据，无需关心底层的 8080 时序。

1.  **等待初始化完成**：上电复位后，模块会自动执行 NT35510 的初始化序列（耗时约 200ms）。在此期间 `lcd_ready` 保持为 `0`。
2.  **检查 Ready 信号**：当 `lcd_ready` 变为 `1` 时，表示屏幕初始化完成，处于空闲状态。
3.  **发送像素**：
    * 将 RGB565 颜色数据送入 `pixel_data`。
    * 将 `pixel_en` 拉高 **1 个时钟周期**。
4.  **等待写入**：模块会自动拉低 `lcd_ready` 并开始发送数据。你需要等待 `lcd_ready` 再次变回 `1`，才能发送下一个像素。

**时序示意：**

```text
             __    __    __    __    __    __    __    __ 
CLK       __|  |__|  |__|  |__|  |__|  |__|  |__|  |__|  
          _____________________________             _____
LCD_READY                              |___________|     
                            ___________
PIXEL_DATA  ----------------<  DATA   >------------------
                            _____
PIXEL_EN  _________________|     |_______________________
                                     ^ 模块捕获数据并开始传输
```
## 四、小游戏内容及操作方式

小游戏以Reimu对抗Cirno的进攻为背景，开始游戏后，在LCD屏幕上显示高清背景图片，并且有随机敌人以随机速度从屏幕顶端下降，你可以通过4x4按键矩阵操控友方人物在屏幕中上下左右移动，并且可以发射子弹击破敌人，在八段数码管上实时显示当前的剩余血量与得分，在使用子弹击破敌人后会加一分，自身被敌人碰撞到后会减少一点血量，当血量值归零后触发游戏结束，显示“Game Over”高清图片。

游戏以4x4按键矩阵实现各种操作，按键映射为

|  <ch> | 向上移动 | <ch>  |  <ch> |
| :--- | :--- | :--- | :--- |
| 向左移动  |   射击   | 向右移动  | <ch>  |
|  <ch> | 向下移动 | <ch>  |   <ch>    |
|  <ch> |  <ch>     |  <ch>    |  <ch>   |

死亡后重新开始按RESET键


